---
layout: post
title: vim随记
---

# 分屏调整命令

- `Ctrl+w =`: 使分屏拥有相同尺寸。
- `Ctrl+w +`: 增大分屏尺寸。
- `Ctrl+w -`: 减小分屏尺寸。

使用场景：将vim全屏后，分屏线不在屏幕中部。可用上述第一个命令加以调整。

# 文件重命名

`:f filename`: 将当前文件重命名为filename。

# 用自增的数字来进行替换

今天写代码遇到一个场景。我需要为5个测试文件写JUnit单元测试代码。测试文件在文件系统中的存储是：

```
$ tree .
├── testfile1
│   └── testfile1.c
├── testfile2
│   └── testfile2.c
├── testfile3
│   └── testfile3.c
├── testfile4
│   └── testfile4.c
└── testfile5
    └── testfile5.c
```

而我IntelliJ IDEA中已有的代码片段是：

```
private String test_KB_27_02_08 = kbCase + "/S_27_02/testfile8/testfile8.c";
```

于是愉快地使用`yy 5p`复制，然后粘贴5行。效果如下：

```
75 private String test_KB_27_02_08 = kbCase + "/S_27_02/testfile8/testfile8.c";
76 private String test_KB_27_02_08 = kbCase + "/S_27_02/testfile8/testfile8.c";
77 private String test_KB_27_02_08 = kbCase + "/S_27_02/testfile8/testfile8.c";
78 private String test_KB_27_02_08 = kbCase + "/S_27_02/testfile8/testfile8.c";
79 private String test_KB_27_02_08 = kbCase + "/S_27_02/testfile8/testfile8.c";
```

那么问题就来了。我应该如何把第75行的8替换成1，76行的8替换成2，以此类推呢。

其实之前遇到过这样的问题。但是没有进行整理。这也说明了写博客的重要性。最终的问题的解决仅仅使用了如下的一条命令：

```
:let i=1 | 75,79 g/8/s//\=i/g | let i+=1
```

`let i=1`定义了`i`的初值；

`75,79` 指定了替换的行号范围，若要替换每一行，则可以用`1,$`或者`%`

`g/8/s//\=i/g`查找每行出现的8，并将其替换成当前的`i`。我很少使用`g`命令，但此处必须用`g`命令，不能改为`s/8/\=i/g`。原因是`s`(substitute)命令是同时对多个匹配到的行进行替换，由此就不能产生所要的递增的效果。

`let i+=1` 每次`g`命令匹配成功并执行相应操作后，将`i`自增。


# 批量文件重命名

今天遇到一个问题。从用例集中自动导出的文件的命名格式都是`case + 数字`形式的，而我本地的测试文件都是以`testfile`开头的。所以我需要将文件名做批量替换。

```
$ tree .
.
├── case10.c
├── case11.c
├── case12.c
├── case13.c
├── case14.c
├── case1.c
├── case2.c
├── case3.c
├── case4.c
├── case5.c
├── case6.c
├── case7.c
├── case8.c
└── case9.c

```

我的需求可以通过rename命令来完成，如下：

```
$ ls
case10.c  case12.c  case14.c  case2.c  case4.c  case6.c  case8.c
case11.c  case13.c  case1.c   case3.c  case5.c  case7.c  case9.c
$ rename 's/case/testfile/' *.c
$ ls
testfile10.c  testfile13.c  testfile2.c  testfile5.c  testfile8.c
testfile11.c  testfile14.c  testfile3.c  testfile6.c  testfile9.c
testfile12.c  testfile1.c   testfile4.c  testfile7.c
```

然后我希望将每个文件都移到同名的文件夹下，例如`testfile1.c`移入`testfile1`中，`testfile2.c`移入`testfile2`中，以此类推。

最终在StackOverflow上找到了答案：

```
$find . -name "*.c" -exec sh -c 'mkdir "${1%.*}" ; mv "$1" "${1%.*}" ' _ {} \;
$tree .
.
├── testfile1
│   └── testfile1.c
├── testfile10
│   └── testfile10.c
├── testfile11
│   └── testfile11.c
├── testfile12
│   └── testfile12.c
├── testfile13
│   └── testfile13.c
├── testfile14
│   └── testfile14.c
├── testfile2
│   └── testfile2.c
├── testfile3
│   └── testfile3.c
├── testfile4
│   └── testfile4.c
├── testfile5
│   └── testfile5.c
├── testfile6
│   └── testfile6.c
├── testfile7
│   └── testfile7.c
├── testfile8
│   └── testfile8.c
└── testfile9
    └── testfile9.c

14 directories, 14 files
```
